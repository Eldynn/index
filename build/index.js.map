{"version":3,"file":"index.js","sources":["../src/Identity.ts","../src/HaveMembers.ts","../src/Member.ts","../src/Group.ts","../src/User.ts","../src/index.ts"],"sourcesContent":["import { Id } from './types';\n\nexport abstract class Identity {\n  public readonly id: Id;\n\n  public constructor(id: Id) {\n    this.id = id;\n  }\n}\n","import { Member } from './Member';\nimport { Identity } from './Identity';\n\nexport abstract class HaveMembers extends Identity {\n  private readonly members: Set<Member> = new Set<Member>();\n\n  public add(member: Member): void {\n    this.members.add(member);\n  }\n\n  public delete(member: Member): void {\n    this.members.delete(member);\n  }\n\n  public destroy(): void {\n    this.members.forEach((member): void => member.destroy());\n    this.members.clear();\n  }\n\n  public get size(): number {\n    return this.members.size;\n  }\n\n  public has(member: Member): boolean {\n    return this.members.has(member);\n  }\n}\n","import { Group } from './Group';\nimport { User } from './User';\n\nexport class Member {\n  public readonly user: User;\n\n  public readonly group: Group;\n\n  public constructor(user: User, group: Group) {\n    this.user = user;\n    this.group = group;\n\n    this.user.add(this);\n    this.group.add(this);\n  }\n\n  public static build(user: User, group: Group): Member {\n    return new Member(user, group);\n  }\n\n  public destroy(): void {\n    this.group.delete(this);\n    this.user.delete(this);\n  }\n}\n","import { HaveMembers } from './HaveMembers';\nimport { Member } from './Member';\nimport { Id } from './types';\nimport { User } from './User';\n\nexport class Group extends HaveMembers {\n  public readonly owner: User;\n\n  public constructor(id: Id, owner: User) {\n    super(id);\n\n    this.owner = owner;\n\n    Member.build(owner, this);\n  }\n}\n","import { HaveMembers } from './HaveMembers';\n\nexport class User extends HaveMembers {}\n","import { Group } from './Group';\nimport { Identity } from './Identity';\nimport { Id } from './types';\nimport { User } from './User';\n\nclass Index {\n  public readonly users: Set<User>;\n\n  public readonly groups: Set<Group>;\n\n  private readonly items: Map<Id, Identity>;\n\n  public constructor() {\n    this.items = new Map<Id, Identity>();\n    this.users = new Set<User>();\n    this.groups = new Set<Group>();\n  }\n\n  public add(identity: Identity): Index {\n    this.items.set(identity.id, identity);\n\n    if (identity instanceof User) {\n      this.users.add(identity);\n    } else if (identity instanceof Group) {\n      this.groups.add(identity);\n    }\n\n    return this;\n  }\n\n  public delete(identity: Identity): Index {\n    this.items.delete(identity.id);\n\n    if (identity instanceof User) {\n      this.users.delete(identity);\n    } else if (identity instanceof Group) {\n      this.groups.delete(identity);\n    }\n\n    return this;\n  }\n\n  public get(id: Id): Identity {\n    return this.items.get(id);\n  }\n}\n\nexport default {\n  Group,\n  Index,\n  User\n};\n"],"names":["_this","Set","tslib_1.__extends","HaveMembers","member","this","members","add","delete","forEach","destroy","clear","Object","size","has","id","user","group","Member","owner","_super","build","items","Map","users","groups","Index","identity","set","User","Group","get"],"mappings":"gfAEA,kBCCA,aAAA,qDACmBA,UAAuB,IAAIC,MAsB9C,OAvB0CC,OAGjCC,gBAAP,SAAWC,GACTC,KAAKC,QAAQC,IAAIH,IAGZD,mBAAP,SAAcC,GACZC,KAAKC,QAAQE,OAAOJ,IAGfD,oBAAP,WACEE,KAAKC,QAAQG,QAAQ,SAACL,GAAiB,OAAAA,EAAOM,YAC9CL,KAAKC,QAAQK,SAGfC,sBAAWT,wBAAX,WACE,OAAOE,KAAKC,QAAQO,sCAGfV,gBAAP,SAAWC,GACT,OAAOC,KAAKC,QAAQQ,IAAIV,ODnB1B,SAAmBW,GACjBV,KAAKU,GAAKA,iBEEZ,WAAmBC,EAAYC,GAC7BZ,KAAKW,KAAOA,EACZX,KAAKY,MAAQA,EAEbZ,KAAKW,KAAKT,IAAIF,MACdA,KAAKY,MAAMV,IAAIF,MAWnB,OARgBa,QAAd,SAAoBF,EAAYC,GAC9B,OAAO,IAAIC,EAAOF,EAAMC,IAGnBC,oBAAP,WACEb,KAAKY,MAAMT,OAAOH,MAClBA,KAAKW,KAAKR,OAAOH,0BCdnB,WAAmBU,EAAQI,GAA3B,MACEC,YAAML,gBAENf,EAAKmB,MAAQA,EAEbD,EAAOG,MAAMF,EAAOnB,KAExB,OAV2BE,UAAAC,iBCH3B,4DAAuC,OAAbD,UAAAC,gBCUxB,aACEE,KAAKiB,MAAQ,IAAIC,IACjBlB,KAAKmB,MAAQ,IAAIvB,IACjBI,KAAKoB,OAAS,IAAIxB,IA8BtB,OA3BSyB,gBAAP,SAAWC,GAST,OARAtB,KAAKiB,MAAMM,IAAID,EAASZ,GAAIY,GAExBA,aAAoBE,EACtBxB,KAAKmB,MAAMjB,IAAIoB,GACNA,aAAoBG,GAC7BzB,KAAKoB,OAAOlB,IAAIoB,GAGXtB,MAGFqB,mBAAP,SAAcC,GASZ,OARAtB,KAAKiB,MAAMd,OAAOmB,EAASZ,IAEvBY,aAAoBE,EACtBxB,KAAKmB,MAAMhB,OAAOmB,GACTA,aAAoBG,GAC7BzB,KAAKoB,OAAOjB,OAAOmB,GAGdtB,MAGFqB,gBAAP,SAAWX,GACT,OAAOV,KAAKiB,MAAMS,IAAIhB,eAIX,CACbe,QACAJ,QACAG"}